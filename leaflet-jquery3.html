<html>
  <head>
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.5/leaflet.css" />
    <script src="http://cdn.leafletjs.com/leaflet-0.5/leaflet.js"></script>

    <script src="http://code.jquery.com/jquery-1.9.1.js"></script>

    <script src="leaflet-providers.js"></script>

    <script type="text/javascript">
      $( function() {
        // Add the logic/behavior when searching the map by clicking the Search button.
        $('input#Search_button').click( function() {
          var zoom = $('#zoom').val();
          var lat = $('#lat').val();
          var lon = $('#lon').val();
         
          map1.setView([lat, lon], zoom);
         
          var p_search = L.marker([lat, lon]);
          p_search.addTo(map1);   
        });
      });

      $(function (){
        // Add the logic/behavior when adding a new marker by clicking the New Marker button.
        $('input#New_marker_button').click( function(){
          var zoom = $('#zoom').val();
          var lat = $('#lat').val();
          var lng = $('#lon').val();

          var temp1 = L.marker([lat, lng], {icon:icons[count % 3], draggable:true});
          temp1.addTo(map1)
            .bindPopup('Marker No.' + (count+2))
            .openPopup();

          count++;
          map1.setView([lat, lng], zoom);
        });
      }); 
    </script>
  </head>

  <body>
    <input type='button' value="Search" id="Search_button">

    Latitude: <input type='text' id='lat' style='width:80;' class="Search_text_fields">
    Longitude: <input type='text' id='lon' style='width:80;' class="Search_text_fields">
    Zoom Level: <input type='text' id='zoom' style='width:80;' class="Search_text_fields">

    <input type='button' value="New Marker" id="New_marker_button">  

    <div id='map1' style='width:65%; height:500px; float:left;'></div>

    <script type="text/javascript">
      // create a map in the "map" div, set the view to a given place and zoom
      var map1 = L.map('map1').setView([14, 121], 5);

      L.tileLayer.provider('MapQuestOpen.OSM').addTo(map1);

      var LeafIcon = L.Icon.extend({
        options: {
          shadowUrl: 'leaf-shadow.png',
          iconSize:     [38, 95],
          shadowSize:   [50, 64],
          iconAnchor:   [22, 94],
          shadowAnchor: [4, 62],
          popupAnchor:  [-3, -76]
        }
      });

      var greenIcon = new LeafIcon({iconUrl: 'leaf-green.png'});
      var redIcon = new LeafIcon({iconUrl: 'leaf-red.png'});
      var orangeIcon = new LeafIcon({iconUrl: 'leaf-orange.png'});

      var icons = new Array();
        icons[0] = greenIcon;
        icons[1] = redIcon;
        icons[2] = orangeIcon;

      var count = 0;
      // add a marker in the given location, attach some popup content to it and open the popup
      var p1 = L.marker([14, 121], {icon: orangeIcon, draggable:true});
      p1.addTo(map1)
        .bindPopup('Marker No.' + (count+1))
        .openPopup();
    </script>
  </body>
</html>
